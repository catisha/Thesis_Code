# Software-Appendix A

## ChIP-seq Peak Identification Software

This appendix describes all of the software and other resources used in this thesis and includes the scripts used to generate and analyse the data, where possible. Code used can be found in the digital appendix under the subheadings given here.

### MACS2

MACS2 version 2.1.0.20151222

See ``macs2_all_samples.sh`` for commands.


### HOMER

HOMER v4.10.1

See ``homer_analysis.sh`` for commands.

### THOR

THOR version 0.11.3

See ``THOR_analysis.sh`` and ``H3K36me3_THOR.config`` for commands.
	
### enRich

enRich version 3.0


See:
* ``enrich_all_chromosomes.sh``
* ``enrich_mycounts_allchromosomes_human_neutrophil_pheonix.R``
* ``combine_chroms_enRich.R``
for commands. 

Note ``enrich_mycounts_allchromosomes_human_neutrophil_pheonix.R`` was run on R version 3.4.1 while ``combine_chroms_enRich.R`` was run on R version 3.5.1.

### MUSIC

See ``MUSIC_analysis.sh`` for commands.

### BCP

BCP version 1.18

See ``BCP_analysis.sh`` for commands.

## R Software and Scripts

### Chapter 2


R version 3.5.1 (2018-07-02)

Platform: x86_64-pc-linux-gnu (64-bit)

Running under: Ubuntu 16.04.5 LTS

**R scripts (see Digital Appendix):}**  
* ``macs_analysis_slim.Rmd``:
Takes peak information generated by the MACS2 program and identifies associated peaks. Also generates thresholds for the program for Chapter 4.
	
* ``HOMER_analysis_slim.Rmd``:
Takes peak information generated by the HOMER program and identifies associated peaks. Also generates thresholds for the program for Chapter 4.
	
* ``THOR_analysis_slim.Rmd``:
Takes peak information generated by the THOR program and identifies associated peaks. Also generates thresholds for the program for Chapter 4.
	
 ``enRich_analysis.Rmd``:
Takes peak information generated by the MUSIC program and identifies associated peaks.}
	
* ``MUSIC_analysis_slim.Rmd``:
Taes peak information generated by the MUSIC program and identifies associated peaks. Also generates thresholds for the program for Chapter 4.
	
* ``BCP_analysis_slim.Rmd``:
Takes peak information generated by the BCP program and identifies associated peaks. Also generates thresholds for the program for Chapter 4.	
	
* ``lca_random_programs.Rmd``:
Combines genes lists from the programs and tests the LCA, LCRE (CL) and LCRE (NCL) models with enRich and without enRich. Generates figures used in Chapter 2.


## Chapter 3

### Simulation Generation

R version 3.4.1 (2017-06-30)

Platform: x86_64-pc-linux-gnu (64-bit)

Running under: Ubuntu 16.04.5 LTS

**R scripts (see Digital Appendix):**

* ``LCA_sim_with_lca_record_commandline_conLoad_pcoef.R``:
	Generates simulation data based on Chapter 3 Methods with a varied threshold and two clusters of scores.
* ``LCA_sim_with_lca_record_contThresh_commandline_conLoad_pcoef.R``:
	Generates simulation data based on Chapter 3 Methods with a constant threshold and two clusters of scores.
* ``LCA_sim_with_lca_record_commandline_conLoad_pcoef_oneclass.R``:
	Generates simulation data based on Chapter 3 Methods with a varied threshold and one cluster of scores.
* ``LCA_sim_with_lca_record_contThresh_commandline_conLoad_pcoef_oneclass.R``: 
	Generates simulation data based on Chapter 3 Methods with a constant threshold and one cluster of scores.	


**Commandline Scripts (see Digital Appendix):**


* ``simulate_LCA_commandline_3methods.sh``: Used to run the top two scripts above with a range of parameters.
* ``simulate_LCA_commandline_1cluster_3methods.sh`` Used to run the bottom two scripts above with a range of parameters.


### Analysis

R version 3.5.1 (2018-07-02)

Platform: x86_64-pc-linux-gnu (64-bit)

Running under: Ubuntu 16.04.5 LTS

**R scripts (see Digital Appendix):**

* ``combined_comparing_parameters_simulation.R``: Takes the simulation data for both varied and constant thresholds, and generates results for the correlation MGMM, the RMSE, the BIC and the sum of scores, as well as additional analyses that were not ued. (Section 3.3.1)
* ``choose_by_BIC.R``: 
Analysis comparing the results when using the BIC based model compared to the results using one of th other LCA models. (Section 3.3.2)
* ``One_class_vs_two_class_analysis.R``: Compares the BIC for a one class model vs a two class model and generates results used for assessment of the BIC. (Section 3.3.3)
* ``nocluster_one_class_vs_two_class_analysisR``: Compares the BIC for a one class model vs a two class model when the underlying only has one cluster and generates results used for assessment of the BIC. (Section 3.3.3)
	


## Chapter 4
### Average Threshold Method Simulation Generation

R version 3.4.4 (2018-03-15) on Pheonix

Platform: x86_64-pc-linux-gnu (64-bit)

Running under: Red Hat Enterprise Linux Server 7.5 (Maipo)

**R Scripts (see Digital Appendix):**

* ``LCA_sim_with_lca_record_change_Thresh_commandline_conLoad_pcoef.R``:
	Generates simulation data for motivating example used in section 4.1.
* ``LCA_sim_3_thresholds_commandline_20rep.R``: 
	Geneates simulation data based on Chapter 4 Methods for the average threshold method.


**Commandline Scripts (see Digital Appendix):**

* ``simulate_LCA_3methods_thresholds_commandline.sh``:
Used to run the above R script for a variety of parameters.


### Analysis

Rversion 3.5.1 (2018-07-02)

Platform: x86_64-pc-linux-gnu (64-bit)

Running under: Ubuntu 16.04.5 LTS

**R Scripts (see Digital Appendix):**
* ``one_scenario_different_thresholds_compare.R``:
	Generates plot for motivating example used in section 4.1.
* ``ave_threshold_results.R``: 
	Take the simulation data of the average thresholds and generates results using the correlation to the MGMM, the RMSE, the sum of scores and the binding gene accuracy for comparison.
* ``Compare_thresholds_ave_fixed.R``: 
	Takes the results from the previous R script and compares them to the results from ``combined_comparing_parameters_simulation.R``.


#Chapter 5
R version 3.5.1 (2018-07-02)

Platform: x86_64-pc-linux-gnu (64-bit)

Running under: Ubuntu 16.04.5 LTS

**R Scripts (see Digital Appendix):**
* ``lca_peak_thresholds.Rmd``: 
	Takes the threshold data from the 5 programs (MACS2, HOMER, THOR, MUSIC and BCP) and applies the average threshold data described in Section 5.2. Analyses and produces the results shown in Section 5.3.

 
